{"version":3,"file":"request-BOr8iG-3.js","sources":["../../../.svelte-kit/adapter-node/chunks/request.js"],"sourcesContent":["import { formatISO } from \"date-fns\";\nimport fs from \"fs\";\nimport crypto from \"crypto\";\nconst BASE_API_URL = \"https://api.kingplay.id/\";\nasync function request({\n  endpoint,\n  method = \"GET\",\n  payload = null,\n  uuid,\n  params\n}) {\n  const timestamp = formatISO(/* @__PURE__ */ new Date(), { representation: \"complete\" });\n  const hashedPayload = crypto.createHash(\"sha256\").update(JSON.stringify(payload ?? {}, null, 0)).digest(\"hex\").toLowerCase();\n  console.log(\"Signature Data\", JSON.stringify([method, endpoint, hashedPayload, timestamp]));\n  const stringToSign = [method, endpoint, hashedPayload, timestamp].join(\":\");\n  const privKey = fs.readFileSync(\"./private-key.pem\");\n  const sign = crypto.createSign(\"RSA-SHA256\");\n  sign.update(stringToSign);\n  const signature = sign.sign(privKey, \"base64\");\n  let finalUrl = new URL(endpoint, BASE_API_URL).href;\n  if (Object.keys(params).length > 0) {\n    const urlSearchParams = new URLSearchParams();\n    for (const key in params) {\n      if (Object.prototype.hasOwnProperty.call(params, key)) {\n        urlSearchParams.append(key, params[key]);\n      }\n    }\n    finalUrl += `?${urlSearchParams.toString()}`;\n  }\n  const headers = new Headers();\n  headers.append(\"X-TIMESTAMP\", timestamp);\n  headers.append(\"X-SIGNATURE\", signature);\n  headers.append(\"Authorization\", `Bearer ${uuid}`);\n  console.log(\"Request Method\", method);\n  console.log(\"Request URL\", finalUrl);\n  console.log(\"Request Headers\", JSON.stringify(Object.fromEntries(headers)));\n  console.log(\"Request Body\", payload);\n  const response = await fetch(finalUrl, { headers });\n  console.log(\"Response Status\", response.status, response.statusText);\n  const data = await response.json();\n  console.log(\"Response Data\", JSON.stringify(data));\n  return {\n    ok: response.ok,\n    data,\n    status: response.status\n  };\n}\nasync function getClientIp() {\n  const getIp = await fetch(\"https://api.ipify.org/?format=json\");\n  const ipData = await getIp.json();\n  return ipData?.ip ?? \"\";\n}\nexport {\n  BASE_API_URL as B,\n  getClientIp as g,\n  request as r\n};\n"],"names":["crypto"],"mappings":"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"}