{"version":3,"file":"store-8a_gaJzG.js","sources":["../../../.svelte-kit/adapter-node/chunks/store.js"],"sourcesContent":["import { d as db } from \"./db.js\";\nasync function getStoreByMember(memberId) {\n  const res = await db.query(\n    \"select * from mt_store s left join mt_store_info msi on msi.id_store = s.id where id_member = $1\",\n    [memberId]\n  );\n  return res?.rows[0] ?? null;\n}\nasync function createStore(data) {\n  try {\n    const res = await db.query(\n      \"insert into mt_store (id_member, name, description, email, phone, domain) values ($1, $2, $3, $4, $5, $6) returning id\",\n      [data.memberId, data.name, data.description, data.email, data.phone, data.domain]\n    );\n    return {\n      error: null,\n      data: res?.rows[0] ?? null\n    };\n  } catch (error) {\n    console.log(error);\n    if (error.code == 23505) {\n      return {\n        error: \"Domain sudah terdaftar\",\n        data: null\n      };\n    }\n    return {\n      error: \"Terjadi kesalahan\",\n      data: null\n    };\n  }\n}\nasync function updateStore(params) {\n  try {\n    const res = await db.query(\n      \"update mt_store set name = $2, description = $3, email = $4, phone = $5, theme = $6, color = $7 where id_member = $1 returning id\",\n      [\n        params.memberId,\n        params.name,\n        params.description,\n        params.email,\n        params.phone,\n        params.theme,\n        params.color\n      ]\n    );\n    return {\n      error: null,\n      data: res?.rows[0] ?? null\n    };\n  } catch (error) {\n    console.log(error);\n    return {\n      error: \"Terjadi kesalahan\",\n      data: null\n    };\n  }\n}\nasync function updateStoreInfo(params) {\n  try {\n    const store = await db.query(\"select id from mt_store where id_member = $1\", [params.memberId]);\n    const storeId = store?.rows[0].id;\n    console.log(storeId);\n    let result;\n    result = await db.query(\n      `update mt_store_info set tiktok = $2, fb = $3, ig = $4, twitter = $5, telegram = $6 where id_store = $1 returning id;`,\n      [storeId, params.tiktok, params.fb, params.ig, params.twitter, params.telegram]\n    );\n    if (!result?.rows || result?.rows.length <= 0) {\n      result = await db.query(\n        `insert into mt_store_info (id_store, tiktok, fb, ig, twitter, telegram) values ($1, $2, $3, $4, $5, $6);`,\n        [storeId, params.tiktok, params.fb, params.ig, params.twitter, params.telegram]\n      );\n    }\n    return {\n      error: null,\n      data: result?.rows[0] ?? null\n    };\n  } catch (error) {\n    console.log(error);\n    return {\n      error: \"Terjadi kesalahan\",\n      data: null\n    };\n  }\n}\nasync function getStoreByDomain(host) {\n  if (host == \"localhost\") {\n    host = \"www.kingplay.id\";\n  }\n  const res = await db.query(\n    \"select * from mt_store ms left join mt_store_info msi on msi.id_store = ms.id where domain = $1 or custom_domain = $1 limit 1\",\n    [host]\n  );\n  return res?.rows[0] ?? null;\n}\nexport {\n  getStoreByMember as a,\n  updateStoreInfo as b,\n  createStore as c,\n  getStoreByDomain as g,\n  updateStore as u\n};\n"],"names":[],"mappings":"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"}